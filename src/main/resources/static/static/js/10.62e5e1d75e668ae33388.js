webpackJsonp([10,32],{"6N/q":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,n=a("woOf"),i=a.n(n),r=a("vt++"),o=(a("0xDb"),a("GoTw")),l=a("weGg"),c=a("IcnI");$("[data-magnify]").magnify({fixedContent:!0,initMaximized:!0});var m={name:"RepairDetail",components:{},props:{repairRecorderInfo:{type:Object,default:{}}},data:function(){return s=this,{loading:{},formData:{},activeTabId:0,statusList:r.a.RepairStatusList,voiceInfo:{voiceIndex:-1,voiceUrl:"",voiceType:"audio/mp3"},skillStars:{},repairMembers:[],issuePositionList:[]}},computed:{isShowAgent:{get:function(){var t=!1;return isStringEmpty(s.formData.machineAgentName)||(t=0==s.formData.forwardInfo),s.activeTabId=t?"0":"1",t}},isShowSinsim:{get:function(){var t=!0;return c.a.getters.user.user.agent>0?t=!1:isStringEmpty(s.formData.machineAgentName)||(t=s.formData.forwardInfo>0),t}}},filters:{filterIssuePosition:function(t){if(isStringEmpty(s.issuePositionList))return"";for(var e="",a=0;a<s.issuePositionList.length;a++)if(t==s.issuePositionList[a].id){e=s.issuePositionList[a].name;break}return e},converterUrl:function(t){return isStringEmpty(t)?"":(t=t.replace(r.a.FilterUrl,"").trim(" "),r.a.WEBURL+t)},filterDateString:function(t){return isStringEmpty(t)?"":new Date(t).format("yyyy-MM-dd")},filterStatus:function(t){for(var e="",a=0;a<s.statusList.length;a++)if(t==s.statusList[a].value){e=s.statusList[a].name;break}return e}},methods:{splitToArray:function(t){return isStringEmpty(t)?"":t.split(",")},onStarLoad:function(t){return Object(l.c)(t.starMode)},onSelectIcon:function(t){var e="voice";return this.voiceInfo.voiceIndex==t&&(e="voice_fill"),e},onSelectVoice:function(t){return this.voiceInfo.voiceIndex==t?"#2b669a":"#d9edf7"},onPlayVoice:function(t,e){var a=document.getElementById("audioId");null!=t&&(t=t.replace(r.a.FilterUrl,"").trim(" "),a.paused||this.voiceInfo.voiceIndex!=e?(this.voiceInfo.voiceUrl=r.a.WEBURL+t,this.voiceInfo.voiceIndex=e,this.voiceInfo.voiceType=getAudioType(t),a.load()):a.pause())},loadMembers:function(){s.repairMembers=[];var t={page:"",size:"",repairRecordId:s.formData.id};Object(o.h)(t).then(function(t){responseIsOK(t)?s.repairMembers=t.data.data.list:showMSG(s,isStringEmpty(t.data.message)?"查询数据失败！":t.data.message)})},loadData:function(){var t=this;Object(o.f)({}).then(function(e){responseIsOK(e)&&(s.issuePositionList=e.data.data.list),t.formData={},t.formData=i()({},s.repairRecorderInfo),t.skillStars=Object(l.d)(s.formData.repairFeedbackCustomerMark),s.loadMembers()})},tabSwitchClick:function(t){console.log("tabSwitchClick:"+t)}},mounted:function(){s.loadData()}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"root_div"},[a("el-form",{attrs:{model:t.formData,"label-position":"right","label-width":"100px"}},[a("div",{staticClass:"panel panel-primary"},[a("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[a("h3",{staticClass:"panel-title"},[t._v("客户信息")])]),t._v(" "),a("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"客户:"}},[a("span",{staticClass:"MainInfo",domProps:{innerHTML:t._s(t.formData.machineCustomerName)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系方式:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.machineCustomerPhone)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"代理商:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.machineAgentName)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系方式:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.machineAgentPhone)}})])],1)],1)]),t._v(" "),a("div",{staticClass:"panel panel-primary"},[a("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[a("h3",{staticClass:"panel-title"},[t._v("机器信息")])]),t._v(" "),a("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"机器编号:"}},[a("span",{staticClass:"MainInfo",domProps:{innerHTML:t._s(t.formData.machineNameplate)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"机型:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.machineType)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"针数:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.needleNum)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"头数:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.headNum)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"头距:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.headDistance)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"X行程:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.xDistance)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"Y行程:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.yDistance)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"出厂日期:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.facoryDate)))])])],1)],1)]),t._v(" "),a("div",{staticClass:"panel panel-primary"},[a("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[a("h3",{staticClass:"panel-title"},[t._v("维修信息")])]),t._v(" "),a("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"维修联系人:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.customerNameInRepairRecord)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系电话:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.customerPhoneInRepairRecord)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"地址:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.customerAddressInRepairRecord)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"报修时间:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.createTime)))])])],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"维修结果:"}},[0==t.formData.status?a("div",{staticStyle:{color:"#000000"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),1==t.formData.status?a("div",{staticStyle:{color:"#686868"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),2==t.formData.status?a("div",{staticStyle:{color:"#8b6c0e"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),3==t.formData.status?a("div",{staticStyle:{color:"#13678b"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),4==t.formData.status?a("div",{staticStyle:{color:"red"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),5==t.formData.status?a("div",{staticStyle:{color:"orange"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),6==t.formData.status?a("div",{staticStyle:{color:"indianred"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),7==t.formData.status?a("div",{staticStyle:{color:"#13ce66"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e(),t._v(" "),8==t.formData.status?a("div",{staticStyle:{color:"#198b57"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.status))+"\n                        ")]):t._e()])],1)],1)]),t._v(" "),a("div",{staticClass:"panel panel-primary"},[a("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[a("h3",{staticClass:"panel-title"},[t._v("报修内容")])]),t._v(" "),a("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"报修时间:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.createTime)))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"报修问题:"}},[a("span",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[t._v(t._s(t.formData.repairRequestTitle))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"文字描述:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.repairRequestContent)}})])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"图片描述:"}},[a("div",t._l(t.splitToArray(t.formData.repairRequestPictures),function(e){return a("a",{attrs:{"data-magnify":"gallery","data-caption":"图片预览",href:t._f("converterUrl")(e)}},[a("img",{staticStyle:{width:"250px",height:"300px",margin:"3px"},attrs:{src:t._f("converterUrl")(e),alt:t._f("converterUrl")(e)}})])}))])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"声音描述:"}},[a("audio",{staticStyle:{"margin-left":"-6px",visibility:"hidden"},attrs:{id:"audioId",autoplay:"true",controls:"controls"}},[a("source",{attrs:{src:t.voiceInfo.voiceUrl,type:t.voiceInfo.voiceType}})]),t._v(" "),t._l(t.splitToArray(t.formData.repairRequestVoice),function(e,s){return a("el-col",{attrs:{span:2}},[a("span",{style:{"border-color":t.onSelectVoice(s)},on:{click:function(a){t.onPlayVoice(e,s)}}},[a("el-tooltip",{attrs:{placement:"top",content:t._f("converterUrl")(e)}},[a("svg-icon",{staticStyle:{width:"100px",height:"100px",margin:"3px",cursor:"hand"},attrs:{"icon-class":t.onSelectIcon(s),"data-toggle":"tooltip","data-placement":"top",title:t._f("converterUrl")(e)},on:{click:function(a){t.onPlayVoice(e,s)}}})],1)],1)])})],2)],1)],1)]),t._v(" "),a("div",{staticClass:"panel panel-primary"},[a("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[a("h3",{staticClass:"panel-title"},[t._v("维修结果")])]),t._v(" "),a("div",{staticClass:"panel-body"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.tabSwitchClick},model:{value:t.activeTabId,callback:function(e){t.activeTabId=e},expression:"activeTabId"}},[t.isShowAgent?a("el-tab-pane",{attrs:{label:"代理商维修",name:"0"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"维修负责人:"}},[a("el-tag",{staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                    "+t._s(t.formData.repairChargePersonName)+"\n                                ")])],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系电话:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.repairChargePersonPhone)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"开始时间:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.repairStartTime)))])])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"完成时间:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.repairEndTime)))])])],1),t._v(" "),a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"维修人员:"}},t._l(t.repairMembers,function(e){return a("el-tag",{key:e.name,staticClass:"tagClass",attrs:{type:"info"}},[t._v("\n                                        "+t._s(e.name)+"\n                                    ")])}))],1)],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"维修员描述:"}},[a("span",[t._v(t._s(t.formData.repairActualIssueDescription))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"解决方案:"}},[a("span",[t._v(t._s(t.formData.repairActualMethod))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"解决方案:"}},[a("span",[t._v(t._s(t.formData.repairActualMethod))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"故障部位:"}},t._l(t.splitToArray(t.formData.issuePositionList),function(e){return a("el-tag",{key:e,staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                        "+t._s(t._f("filterIssuePosition")(e))+"\n\t                            ")])}))],1)],1):t._e(),t._v(" "),t.isShowSinsim?a("el-tab-pane",{attrs:{label:"信胜维修",name:"1"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"维修负责人:"}},[a("el-tag",{staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                    "+t._s(t.formData.repairChargePersonName)+"\n                                ")])],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系电话:"}},[a("span",{domProps:{innerHTML:t._s(t.formData.repairChargePersonPhone)}})])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"开始时间:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.repairStartTime)))])])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"完成时间:"}},[a("span",[t._v(t._s(t._f("filterDateString")(t.formData.repairEndTime)))])])],1),t._v(" "),a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"维修人员:"}},t._l(t.repairMembers,function(e){return a("el-tag",{key:e.name,staticClass:"tagClass",attrs:{type:"info"}},[t._v("\n                                        "+t._s(e.name)+"\n                                     ")])}))],1)],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"维修员描述:"}},[a("span",[t._v(t._s(t.formData.repairActualIssueDescription))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"解决方案:"}},[a("span",[t._v(t._s(t.formData.repairActualMethod))])])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"故障部位:"}},t._l(t.splitToArray(t.formData.issuePositionList),function(e){return a("el-tag",{key:e,staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                        "+t._s(t._f("filterIssuePosition")(e))+"\n\t                            ")])}))],1)],1):t._e(),t._v(" "),a("el-tab-pane",{attrs:{label:"客户评价",name:"2"}},[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"用户评分:"}},[a("div",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[t._l(t.skillStars,function(e){return a("div",{staticStyle:{float:"left"}},[a("svg-icon",{staticStyle:{width:"30px",height:"30px",margin:"3px"},attrs:{"icon-class":t.onStarLoad(e),"data-toggle":"tooltip","data-placement":"top",title:e.score}})],1)}),t._v(" "),""!=t.formData.repairFeedbackCustomerMark?a("div",{staticClass:"control-label",staticStyle:{float:"left","margin-left":"10px","font-weight":"bold"}},[t._v("\n                                        "+t._s(t.formData.repairFeedbackCustomerMark)+"分\n                                    ")]):a("div",{staticClass:"control-label",staticStyle:{float:"left","margin-left":"10px","font-weight":"bold"}},[t._v("\n                                        暂无评分\n                                    ")])],2)])],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"用户评论:"}},[a("div",{staticClass:"control-label",staticStyle:{float:"left","margin-left":"10px","font-weight":"bold"}},[t._v("\n                                    "+t._s(t.formData.repairFeedbackCustomerSuggestion)+"\n                                ")])])],1)],1)],1)],1)])])],1)},staticRenderFns:[]};var f=a("VU/8")(m,d,!1,function(t){a("ZFdm")},"data-v-22e21efc",null);e.default=f.exports},"8GS5":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,n=a("woOf"),i=a.n(n),r=a("vt++"),o=(a("zL8q"),a("GoTw")),l=a("weGg"),c=a("6N/q"),m=a("cNRr"),d={name:"repair_home",components:{RepairDetail:c.default,AssignTask:m.default},data:function(){return s=this,{formData:{},machineNameplate:"",selectedItem:{},machineInfo:{},activeTabId:"0",tableData:[],pageSize:r.a.EveryPageNum,currentPage:1,startRow:0,totalRecords:0,statusList:r.a.RepairStatusList,inWarrantyPeriodList:r.a.InWarrantyPeriodList,agentOrderList:r.a.YESORNOList,employeeList:[],condition:{nameplate:"",orderNum:"",machineType:"",customer:"",isAgent:!0,agent:"",status:"",inWarrantyPeriod:"",dateType:"",selectDate:""},allMachineType:[],allRoles:[],loadingUI:!1,showDetailDialog:!1,showAssignTaskDialog:!1,showConfirmAssign:!1,assignTaskData:{formData:{planDate:"",customerName:""},workerList:[]},issuePositionList:[],isDisableOK:!1,showConfirmForward:!1,assignTaskType:r.a.AssignTaskType.REPAIR,pickerOptions:r.a.DateRangeOptions}},filters:{filterIssuePosition:function(t){for(var e="",a=0;a<s.issuePositionList.length;a++)if(t==s.issuePositionList[a].id){e=s.issuePositionList[a].name;break}return e},filterDateString:function(t){return isUndefined(t)||isNull(t)||0==t.length?"":new Date(t).format("yyyy-MM-dd")},filterStatus:function(t){for(var e=s.statusList[0].name,a=0;a<s.statusList.length;a++)if(t==s.statusList[a].value){e=s.statusList[a].name;break}return e},filterMachineType:function(t){for(var e="",a=0;a<s.allMachineType.length;a++)if(t==s.allMachineType[a].id){e=s.allMachineType[a].name;break}return e},filterInWarrantyPeriod:function(t){for(var e="",a=0;a<s.inWarrantyPeriodList.length;a++)if(t==s.inWarrantyPeriodList[a].value){e=s.inWarrantyPeriodList[a].name;break}return e}},computed:{isShowAssignButton:function(t){return!(1==t.forwardInfo&&s.$store.getters.user.user.agent>0)&&!(t.status>3)},isShowAssignForwardButton:function(t){return 3==t.status&&""!=t.machineAgentName}},methods:{isAgentLogin:function(){return"0"!=s.$store.getters.user.user.agent&&""!=s.$store.getters.user.user.agent},splitToArray:function(t){return 0==t.length?"":t.split(",")},onConForward:function(){s.showConfirmForward=!1;var t={oldId:s.selectedItem.id,repairRecord:{machineNameplate:s.selectedItem.machineNameplate,repairRequestInfo:s.selectedItem.repairRequestInfo,inWarrantyPeriod:s.selectedItem.inWarrantyPeriod}};Object(o.c)(t).then(function(t){responseIsOK(t)?(showMSG(s,"转派成功！",1),s.onSearchDetailData()):showMSG(s,isStringEmpty(t.data.message)?"转派失败！":t.data.message)})},onConShowAssign:function(){s.machineInfo.machineCustomerCompanyId=s.selectedItem.machineCustomerCompanyId,s.machineInfo.customerId=s.selectedItem.machineCustomerId,s.machineInfo.customerName=s.selectedItem.machineCustomerName,s.machineInfo.factoryDate||(s.machineInfo.factoryDate=DateMinus(s.selectedItem.facoryDate)),s.showConfirmAssign=!1,s.showAssignTaskDialog=!0,this.$refs.assignTask&&s.$refs.assignTask.loadData()},dataChanged:function(t){s.assignTaskData=i()({},t)},assignTask:function(t){s.machineInfo={factoryDate:DateMinus(s.selectedItem.facoryDate)},s.selectedItem=copyObject(t),2==s.selectedItem.status?s.showConfirmAssign=!0:s.onConShowAssign()},forwardTask:function(t){s.selectedItem=copyObject(t),s.showConfirmForward=!0},onConfirmAssign:function(){if(this.$refs.assignTask&&(s.assignTaskData=s.$refs.assignTask.getCurrentData()),null==s.assignTaskData||s.assignTaskData.length<0)showMessage(s,"请填写完整的派单数据！");else if(isUndefined(s.assignTaskData.formData.chargePersonId)||0==s.assignTaskData.formData.chargePersonId)showMessage(s,"请选择负责人！");else if(isStringEmpty(s.assignTaskData.formData.planDate))showMessage(s,"请选择上门日期！");else if(isStringEmpty(s.assignTaskData.workerList))showMessage(s,"请选择要派出的工人！");else{s.showAssignTaskDialog=!1;var t=[];s.assignTaskData.workerList.forEach(function(e){t.push({userId:e.id,repairRecordId:s.selectedItem.id})});var e={repairRecord:{repairChargePerson:s.assignTaskData.formData.chargePersonId,customer:s.assignTaskData.formData.customerId,repairPlanDate:s.assignTaskData.formData.planDate,inWarrantyPeriod:s.assignTaskData.formData.inWarrantyPeriod},repairMembers:t};isStringEmpty(s.assignTaskData.formData.customerName)&&(e.customer=s.selectedItem.machineCustomerId),s.selectedItem.status>1&&s.selectedItem.status<4?(e.oldId=s.selectedItem.id,e.repairRecord.machineNameplate=s.selectedItem.machineNameplate,e.repairRecord.repairRequestInfo=s.selectedItem.repairRequestInfo,Object(o.b)(e).then(function(t){responseIsOK(t)?(showMSG(s,"再派单成功！",1),s.onSearchDetailData()):showMSG(s,isStringEmpty(t.data.message)?"再派单失败！":t.data.message)})):(e.repairRecord.id=s.selectedItem.id,Object(o.d)(e).then(function(t){responseIsOK(t)?(showMSG(s,"派单成功！",1),s.onSearchDetailData()):showMSG(s,isStringEmpty(t.data.message)?"派单失败！":t.data.message)}))}},handleCurrentChange:function(t){this.currentPage=t,this.search()},search:function(){this.onSearchDetailData()},onSearchDetailData:function(){var t={orderNum:this.condition.orderNum.trim(),nameplate:this.condition.nameplate.trim(),machineType:this.condition.machineType,queryStartRepairCreateTime:"",queryFinishRepairCreateTime:"",queryStartRepairEndTime:"",queryFinishRepairEndTime:"",agent:s.isAgentLogin()?s.$store.getters.user.user.agentName:this.condition.agent,isAgent:s.isAgentLogin(),repairRecordCustomerName:this.condition.customer,repairStatus:this.condition.status,partsStatus:"",repairChargePersonName:"",inWarrantyPeriod:this.condition.inWarrantyPeriod,issuePositionName:"",page:this.currentPage,size:this.pageSize,isFuzzy:!0};null!=this.condition.selectDate&&this.condition.selectDate.length>0&&(0==t.dateType?(t.queryStartRepairCreateTime=this.condition.selectDate[0].format("yyyy-MM-dd"),t.queryFinishRepairCreateTime=this.condition.selectDate[1].format("yyyy-MM-dd")):(t.queryStartRepairEndTime=this.condition.selectDate[0].format("yyyy-MM-dd"),t.queryFinishRepairEndTime=this.condition.selectDate[1].format("yyyy-MM-dd"))),Object(o.i)(t).then(function(t){responseIsOK(t)?(s.tableData=t.data.data.list,s.totalRecords=t.data.data.total,s.startRow=t.data.data.startRow):showMSG(s,isStringEmpty(t.data.message)?"加载数据失败！":t.data.message)})},editWithItem:function(t){s.selectedItem=copyObject(t),s.showDetailDialog=!0,this.$refs.repairDetail&&s.$refs.repairDetail.loadData()},initData:function(){s.$store.getters.commonData.machineTypeList.length>0?s.allMachineType=s.$store.getters.commonData.machineTypeList:s.$store.dispatch("getAllMachineType").then(function(){s.allMachineType=s.$store.getters.commonData.machineTypeList}).catch(function(t){showMSG(s,"getAllMachineType failed!")}),Object(o.f)({}).then(function(t){responseIsOK(t)&&(s.issuePositionList=t.data.data.list)}),Object(l.f)().then(function(t){responseIsOK(t)&&(s.employeeList=t.data.data.list)})}},created:function(){this.initData(),this.search()}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"root_div"},[a("div",[a("el-col",{staticClass:"well well-lg",staticStyle:{"background-color":"white"}},[a("el-form",{attrs:{model:t.condition,"label-position":"right","label-width":"90px"}},[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"机器编号:"}},[a("el-input",{attrs:{placeholder:"机器编号",clearable:"","auto-complete":"off"},model:{value:t.condition.nameplate,callback:function(e){t.$set(t.condition,"nameplate",e)},expression:"condition.nameplate"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"订单编号:"}},[a("el-input",{attrs:{placeholder:"订单编号",clearable:"","auto-complete":"off"},model:{value:t.condition.orderNum,callback:function(e){t.$set(t.condition,"orderNum",e)},expression:"condition.orderNum"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{attrs:{clearable:""},model:{value:t.condition.status,callback:function(e){t.$set(t.condition,"status",e)},expression:"condition.status"}},t._l(t.statusList,function(t){return a("el-option",{attrs:{value:t.value,label:t.name}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"客户:"}},[a("el-input",{attrs:{placeholder:"客户",clearable:"","auto-complete":"off"},model:{value:t.condition.customer,callback:function(e){t.$set(t.condition,"customer",e)},expression:"condition.customer"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:2,offset:1}},[a("el-button",{attrs:{icon:"el-icon-search",size:"normal",type:"primary"},on:{click:t.search}},[t._v("查询\n                            ")])],1)],1),t._v(" "),a("el-row",[a("el-col",{directives:[{name:"show",rawName:"v-show",value:!t.isAgentLogin(),expression:"!isAgentLogin()"}],attrs:{span:5}},[a("el-form-item",{attrs:{label:"显示代理商:"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:t.condition.isAgent,callback:function(e){t.$set(t.condition,"isAgent",e)},expression:"condition.isAgent"}})],1)],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:!t.isAgentLogin()&&t.condition.isAgent,expression:"!isAgentLogin()&&condition.isAgent"}],attrs:{span:5}},[a("el-form-item",{attrs:{label:"代理商:"}},[a("el-input",{attrs:{placeholder:"代理商",clearable:"","auto-complete":"off"},model:{value:t.condition.agent,callback:function(e){t.$set(t.condition,"agent",e)},expression:"condition.agent"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"代理商改派:"}},[a("el-select",{attrs:{clearable:""},model:{value:t.condition.isAgentOrder,callback:function(e){t.$set(t.condition,"isAgentOrder",e)},expression:"condition.isAgentOrder"}},t._l(t.agentOrderList,function(t){return a("el-option",{attrs:{value:t.value,label:t.text}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"维修员:"}},[a("el-select",{attrs:{clearable:""},model:{value:t.condition.repairChargePersonName,callback:function(e){t.$set(t.condition,"repairChargePersonName",e)},expression:"condition.repairChargePersonName"}},t._l(t.employeeList,function(t){return a("el-option",{attrs:{value:t.id,label:t.name}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"故障部位:"}},[a("el-input",{attrs:{placeholder:"故障部位",clearable:"","auto-complete":"off"},model:{value:t.condition.issuePositionName,callback:function(e){t.$set(t.condition,"issuePositionName",e)},expression:"condition.issuePositionName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"保修期内:"}},[a("el-select",{attrs:{clearable:""},model:{value:t.condition.inWarrantyPeriod,callback:function(e){t.$set(t.condition,"inWarrantyPeriod",e)},expression:"condition.inWarrantyPeriod"}},t._l(t.inWarrantyPeriodList,function(t){return a("el-option",{attrs:{value:t.value,label:t.name}})}))],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"查询日期"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.condition.dateType,callback:function(e){t.$set(t.condition,"dateType",e)},expression:"condition.dateType"}},[a("el-option",{attrs:{label:"报修日期",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"完成日期",value:"1"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:":"}},[a("el-date-picker",{attrs:{clearable:"",type:"daterange",align:"left","unlink-panels":"","range-separator":"—","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.condition.selectDate,callback:function(e){t.$set(t.condition,"selectDate",e)},expression:"condition.selectDate"}})],1)],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingUI,expression:"loadingUI"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"获取数据中...",data:t.tableData,border:"","empty-text":"暂无数据...","highlight-current-row":"","show-overflow-tooltip":"true"}},[a("el-table-column",{attrs:{width:"75",align:"center",label:"序号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                            "+t._s(e.$index+t.startRow)+"\n                        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"machineNameplate",label:"机器编号"}}),t._v(" "),a("el-table-column",{attrs:{label:"订单号",sortable:"",align:"center",prop:"orderNum"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n                                "+t._s(e.row.orderNum)+"\n                            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"machineCustomerName",label:"客户"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"customerNameInRepairRecord",label:"联系人"}}),t._v(" "),t.isAgentLogin()?t._e():a("el-table-column",{attrs:{align:"center",prop:"machineAgentName",label:"代理商"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",sortable:"",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?a("div",{staticStyle:{color:"#000000"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),1==e.row.status?a("div",{staticStyle:{color:"#686868"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),2==e.row.status?a("div",{staticStyle:{color:"#8b6c0e"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),3==e.row.status?a("div",{staticStyle:{color:"#13678b"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),4==e.row.status?a("div",{staticStyle:{color:"red"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),5==e.row.status?a("div",{staticStyle:{color:"orange"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),6==e.row.status?a("div",{staticStyle:{color:"indianred"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),7==e.row.status?a("div",{staticStyle:{color:"#13ce66"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e(),t._v(" "),8==e.row.status?a("div",{staticStyle:{color:"#198b57"}},[t._v("\n                                "+t._s(t._f("filterStatus")(e.row.status))+"\n                            ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"故障部位",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.splitToArray(e.row.issuePositionList),function(e){return a("el-tag",{key:e,staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                        "+t._s(t._f("filterIssuePosition")(e))+"\n\t                         ")])})}}])}),t._v(" "),a("el-table-column",{attrs:{label:"保修期内",sortable:"",align:"center",prop:"inWarrantyPeriod"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.inWarrantyPeriod?a("div",{staticStyle:{color:"green"}},[t._v("\n                                 "+t._s(t._f("filterInWarrantyPeriod")(e.row.inWarrantyPeriod))+"\n                            ")]):a("div",{staticStyle:{color:"red"}},[t._v("\n                                "+t._s(t._f("filterInWarrantyPeriod")(e.row.inWarrantyPeriod))+"\n                            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"维修员",sortable:"",align:"center",prop:"repairChargePersonName"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n                                "+t._s(e.row.repairChargePersonName)+"\n                            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"代理商改派",align:"center",prop:"orderNum"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",["1"==e.row.forwardInfo?a("span",[t._v("\n\t\t                            是\n\t                            ")]):a("span",[t._v("\n\t                                否\n\t                            ")])])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"createTime",label:"报修日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("\n                            "+t._s(t._f("filterDateString")(e.row.createTime))+"\n                        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"repairEndTime",label:"完成日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("\n                            "+t._s(t._f("filterDateString")(e.row.repairEndTime))+"\n                        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{placement:"top",content:"详情"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-view"},on:{click:function(a){t.editWithItem(e.row)}}})],1),t._v(" "),a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.row.status<=4&&!(2==e.row.forwardInfo&&t.$store.getters.user.user.agent>0),expression:"(scope.row.status<=4)&&!(scope.row.forwardInfo==2 && $store.getters.user.user.agent > 0)"}],attrs:{placement:"top",content:"派单"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-news"},on:{click:function(a){t.assignTask(e.row)}}})],1),t._v(" "),a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:4==e.row.status&&""!=e.row.machineAgentName&&1!=e.row.forwardInfo,expression:"scope.row.status == 4 && scope.row.machineAgentName != ''&&scope.row.forwardInfo!=1"}],attrs:{placement:"top",content:"转派"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-refresh"},on:{click:function(a){t.forwardTask(e.row)}}})],1)]}}])})],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next, jumper",total:t.totalRecords},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"确认转派",visible:t.showConfirmForward,"append-to-body":"",width:"30%"},on:{"update:visible":function(e){t.showConfirmForward=e}}},[a("span",[t._v("当前任务状态是"),a("span",{staticStyle:{"font-weight":"bold","font-size":"18px",color:"#1c8de0"}},[t._v(" "+t._s(t._f("filterStatus")(t.selectedItem.status)))]),t._v(", 确定需要转派本次维修吗？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(e){t.showConfirmForward=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.onConForward}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"查看",visible:t.showDetailDialog,"append-to-body":"",fullscreen:""},on:{"update:visible":function(e){t.showDetailDialog=e}}},[t.showDetailDialog?a("RepairDetail",{ref:"repairDetail",attrs:{repairRecorderInfo:t.selectedItem}}):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:"派单",visible:t.showAssignTaskDialog,"append-to-body":"",width:"75%"},on:{"update:visible":function(e){t.showAssignTaskDialog=e}}},[t.showAssignTaskDialog?a("AssignTask",{ref:"assignTask",attrs:{showType:t.assignTaskType,machineInfo:t.machineInfo,dataChanged:t.dataChanged}}):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"margin-bottom":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check",disabled:t.isDisableOK},on:{click:t.onConfirmAssign}},[t._v("确定\n                        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-back"},on:{click:function(e){t.showAssignTaskDialog=!1}}},[t._v("关闭")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"提示",visible:t.showConfirmAssign,"append-to-body":"",width:"30%"},on:{"update:visible":function(e){t.showConfirmAssign=e}}},[a("span",[t._v("当前任务状态是"),a("span",{staticStyle:{"font-weight":"bold","font-size":"18px",color:"#1c8de0"}},[t._v(" "+t._s(t._f("filterStatus")(t.selectedItem.status)))]),t._v(", 确定需要再次派单吗？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(e){t.showConfirmAssign=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.onConShowAssign}},[t._v("确 定")])],1)])],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(d,f,!1,function(t){a("t/X6")},"data-v-05ad4be9",null);e.default=p.exports},Ugc3:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.root_div[data-v-05ad4be9] {\n\tposition: relative;\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 85vh;\n}\n.el-select[data-v-05ad4be9] {\n\twidth: 100%;\n}\n.tagClass[data-v-05ad4be9] {\n\tmargin-left: 5px;\n\twidth: 100px;\n}\n",""])},ZFdm:function(t,e,a){var s=a("jbfW");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("f560a0ce",s,!0)},jbfW:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.root_div[data-v-22e21efc] {\n\tposition: relative;\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 85vh;\n}\n.MainInfo[data-v-22e21efc] {\n\tfont-weight: bold;\n\tcolor: #2b542c;\n}\n.tagClass[data-v-22e21efc] {\n\tmargin-left: 5px;\n\twidth: 200px;\n}\nspan[data-v-22e21efc] {\n\tfont-size: 18px;\n\twidth: 100%;\n\talignment: left;\n\ttext-align: left;\n}\n\n",""])},"t/X6":function(t,e,a){var s=a("Ugc3");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("53679cff",s,!0)}});