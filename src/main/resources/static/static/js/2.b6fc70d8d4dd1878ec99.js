webpackJsonp([2,6,25],{"+lcp":function(t,a,e){var n=e("3Ruw");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e("rjj0")("6ef7c68e",n,!0)},"0Iwh":function(t,a,e){var n=e("BDiL");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e("rjj0")("6cf4f7f6",n,!0)},"3Ruw":function(t,a,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n.root_div[data-v-6e3a84b7] {\n\t    position: relative;\n\t    padding: 20px;\n\t    width: 100%;\n\t    height: 85vh;\n}\n.input-with-select .el-input-group__prepend[data-v-6e3a84b7] {\n\t    background-color: #fff;\n}\n.el-select[data-v-6e3a84b7] {\n\t    width: 100%;\n}\n",""])},"9bBU":function(t,a,e){e("mClu");var n=e("FeBl").Object;t.exports=function(t,a,e){return n.defineProperty(t,a,e)}},BDiL:function(t,a,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n.input-with-select .el-input-group__prepend[data-v-ecc22230] {\n\tbackground-color: #fff;\n}\nspan[data-v-ecc22230] {\n\tfont-size: 18px;\n\twidth: 100%;\n\talignment: left;\n\ttext-align: left;\n}\n",""])},C4MV:function(t,a,e){t.exports={default:e("9bBU"),__esModule:!0}},Ii3P:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n,i=e("woOf"),s=e.n(i),l=e("BO1k"),o=e.n(l),r=e("mvHQ"),c=e.n(r),m=e("vt++"),d=(e("zL8q"),e("V5TU")),u=e("KzIj"),f=e("cNRr"),p=e("d/Vj"),g=(e("0xDb"),{name:"maintain_home",components:{AssignTask:f.default,SelectAssignMachine:p.default,MaintainDetail:u.default},data:function(){return n=this,{machineNameplate:"",selectedItem:{},tableData:[],pageSize:m.a.EveryPageNum,currentPage:1,startRow:0,totalRecords:0,statusList:m.a.MaintainStatusList,finishList:m.a.YESORNOList,condition:{nameplate:"",orderNum:"",machineType:"",customer:"",isAgent:!0,agent:"",status:"",maintainChargePerson:"",selectDate:""},showDetailDialog:!1,showAssignTaskDialog:!1,showConfirmAssign:!1,assignTaskData:{formData:{planDate:"",customerName:""},workerList:[]},showSelectMachineDialog:!1,selectedMachineList:[],mainTainLibList:[],machineInfo:{},assignTaskType:m.a.AssignTaskType.MAINTAIN,pickerOptions:m.a.DateRangeOptions,showMaintainDialog:!1,maintainLibName:""}},filters:{filterDateString:function(t){return isUndefined(t)||isNull(t)||0==t.length?"":new Date(t).format("yyyy-MM-dd")},filterStatus:function(t){for(var a=n.statusList[0].name,e=0;e<n.statusList.length;e++)if(t==n.statusList[e].value){a=n.statusList[e].name;break}return a}},computed:{isDisableOK:{get:function(){return""==n.assignTaskData.formData.planDate||""==n.assignTaskData.formData.customerName||n.assignTaskData.workerList.length<1}}},methods:{isAgentLogin:function(){return"0"!=n.$store.getters.user.user.agent&&""!=n.$store.getters.user.user.agent},onSaveMaintain:function(){var t={id:n.selectedItem.id,maintainLibName:n.maintainLibName};isStringEmpty(n.maintainLibName)?showMessage(n,"请选择保养项！"):(n.showMaintainDialog=!1,Object(d.l)(t).then(function(t){responseIsOK(t)?(showMSG(n,"设置保养项成功！",1),n.onSearchDetailData()):showMSG(n,isStringEmpty(t.data.message)?"提交保养数据失败！":t.data.message)}))},onEditMaintainLib:function(t){n.selectedItem=copyObject(t),n.maintainLibName=n.selectedItem.maintainLibName,n.showMaintainDialog=!0},onSelectMachineChanged:function(t){n.selectedMachineList=t},onShowSelectMachine:function(){n.selectedMachineList=[],n.showSelectMachineDialog=!0},onSelectMachineOK:function(){if(isStringEmpty(n.selectedMachineList))showMessage(n,"请选择要保养的机器！");else if(n.showSelectMachineDialog=!1,this.$refs.selectMachineControl&&(n.selectedMachineList=n.$refs.selectMachineControl.getCurrentData()),n.selectedMachineList.length>0){var t=[],a=!0,e=!1,i=void 0;try{for(var s,l=o()(n.selectedMachineList);!(a=(s=l.next()).done);a=!0){var r=s.value;t.push({machineNameplate:r.nameplate,createTime:(new Date).format("yyyy-MM-dd"),maintainStatus:0,id:""})}}catch(t){e=!0,i=t}finally{try{!a&&l.return&&l.return()}finally{if(e)throw i}}Object(d.a)({maintainRecordList:c()(t)}).then(function(t){responseIsOK(t)?(showMSG(n,"新增保养成功,记得设置保养项！",1),n.onSearchDetailData()):showMSG(n,isStringEmpty(t.data.message)?"新增保养数据失败！":t.data.message)})}},onConShowAssign:function(){n.showConfirmAssign=!1,n.showAssignTaskDialog=!0,this.$refs.assignTask&&n.$refs.assignTask.loadData()},dataChanged:function(t){n.assignTaskData=s()({},t)},handleCurrentChange:function(t){this.currentPage=t,this.search()},search:function(){this.onSearchDetailData()},onSearchDetailData:function(){var t={orderNum:this.condition.orderNum.trim(),nameplate:this.condition.nameplate.trim(),machineType:this.condition.machineType,agent:n.isAgentLogin()?n.$store.getters.user.user.agentName:this.condition.agent,isAgent:n.isAgentLogin(),customerName:this.condition.customer,maintainChargePerson:this.condition.maintainChargePerson,maintainStatus:this.condition.status,query_start_time_maintain:"",query_finish_time_maintain:"",page:this.currentPage,size:this.pageSize,isFuzzy:!0};null!=this.condition.selectDate&&this.condition.selectDate.length>0&&(t.query_start_time_maintain=this.condition.selectDate[0].format("yyyy-MM-dd"),t.query_finish_time_maintain=this.condition.selectDate[1].format("yyyy-MM-dd")),Object(d.i)(t).then(function(t){responseIsOK(t)?(n.tableData=t.data.data.list,n.totalRecords=t.data.data.total,n.startRow=t.data.data.startRow):showMSG(n,isStringEmpty(t.data.message)?"查询数据失败！":t.data.message)})},assignTask:function(t){""!=t.maintainLibName&&null!=t.maintainLibName?(n.selectedItem=copyObject(t),n.machineInfo.machineCustomerCompanyId=n.selectedItem.machineCustomerCompanyId,n.machineInfo.customerId=n.selectedItem.machineCustomerId,n.machineInfo.customerName=n.selectedItem.machineCustomerName,n.selectedItem.maintainStatus>0?n.showConfirmAssign=!0:n.onConShowAssign()):showMessage(n,"请先设置保养项再派单！")},onConfirmAssign:function(){if(this.$refs.assignTask&&(n.assignTaskData=n.$refs.assignTask.getCurrentData()),null==n.assignTaskData||n.assignTaskData.length<0)showMessage(n,"请填写完整的派单数据！");else if(0!=n.assignTaskData.formData.chargePersonId)if(isStringEmpty(n.assignTaskData.formData.planDate))showMessage(n,"请选择上门日期！");else if(isStringEmpty(n.assignTaskData.workerList))showMessage(n,"请选择要派出的工人！");else{n.showAssignTaskDialog=!1;var t=[];n.assignTaskData.workerList.forEach(function(a){t.push({userId:a.id,maintainRecordId:n.selectedItem.id})});var a={maintainRecord:{id:n.selectedItem.id,maintainChargePerson:n.assignTaskData.formData.chargePersonId,customer:n.assignTaskData.formData.customerId,maintainDatePlan:n.assignTaskData.formData.planDate},maintainMembers:t};isStringEmpty(n.assignTaskData.formData.customerName)&&(a.customer=n.selectedItem.machineCustomerId),Object(d.d)(a).then(function(t){responseIsOK(t)?(showMSG(n,"分配任务成功！",1),n.onSearchDetailData()):showMSG(n,isStringEmpty(t.data.message)?"分配任务失败！":t.data.message)})}else showMessage(n,"请选择负责人！")},editWithItem:function(t){n.selectedItem=t,n.machineNameplate=t.machineNameplate,n.showDetailDialog=!0,this.$refs.maintainDetail&&n.$refs.maintainDetail.loadData()},initMaintainLibList:function(){Object(d.k)({maintainType:"",maintainLibName:""}).then(function(t){responseIsOK(t)&&(n.mainTainLibList=t.data.data.list)})}},created:function(){n.initMaintainLibList(),this.search()}}),h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"root_div"},[e("div",[e("el-col",{staticClass:"well well-lg",staticStyle:{"background-color":"white"}},[e("el-form",{attrs:{model:t.condition,"label-position":"right","label-width":"90px"}},[e("el-row",[e("el-col",{attrs:{span:5}},[e("el-form-item",{attrs:{label:"机器编号:"}},[e("el-input",{attrs:{placeholder:"机器编号",clearable:"","auto-complete":"off"},model:{value:t.condition.nameplate,callback:function(a){t.$set(t.condition,"nameplate",a)},expression:"condition.nameplate"}})],1)],1),t._v(" "),e("el-col",{directives:[{name:"show",rawName:"v-show",value:!t.isAgentLogin(),expression:"!isAgentLogin()"}],attrs:{span:3,offset:1}},[e("el-form-item",{attrs:{label:"显示代理商:"}},[e("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:t.condition.isAgent,callback:function(a){t.$set(t.condition,"isAgent",a)},expression:"condition.isAgent"}})],1)],1),t._v(" "),e("el-col",{directives:[{name:"show",rawName:"v-show",value:!t.isAgentLogin()&&t.condition.isAgent,expression:"!isAgentLogin()&&condition.isAgent"}],attrs:{span:5}},[e("el-form-item",{attrs:{label:""}},[e("el-input",{attrs:{placeholder:"代理商",clearable:"","auto-complete":"off"},model:{value:t.condition.agent,callback:function(a){t.$set(t.condition,"agent",a)},expression:"condition.agent"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:5}},[e("el-form-item",{attrs:{label:"订单编号:"}},[e("el-input",{attrs:{placeholder:"订单号",clearable:"","auto-complete":"off"},model:{value:t.condition.orderNum,callback:function(a){t.$set(t.condition,"orderNum",a)},expression:"condition.orderNum"}})],1)],1),t._v(" "),e("el-col",{attrs:{span:5}},[e("el-form-item",{attrs:{label:"完成状态:"}},[e("el-select",{attrs:{clearable:""},model:{value:t.condition.status,callback:function(a){t.$set(t.condition,"status",a)},expression:"condition.status"}},t._l(t.statusList,function(t){return e("el-option",{attrs:{value:t.value,label:t.name}})}))],1)],1),t._v(" "),e("el-col",{attrs:{span:5}},[e("el-form-item",{attrs:{label:"客户:"}},[e("el-input",{attrs:{placeholder:"客户",clearable:"","auto-complete":"off"},model:{value:t.condition.customer,callback:function(a){t.$set(t.condition,"customer",a)},expression:"condition.customer"}})],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-form-item",{attrs:{label:"保养员:"}},[e("el-input",{attrs:{placeholder:"保养员",clearable:"","auto-complete":"off"},model:{value:t.condition.maintainChargePerson,callback:function(a){t.$set(t.condition,"maintainChargePerson",a)},expression:"condition.maintainChargePerson"}})],1)],1),t._v(" "),e("el-col",{attrs:{span:2,offset:3}},[e("el-button",{attrs:{icon:"el-icon-search",size:"normal",type:"primary"},on:{click:t.search}},[t._v("查询\n                            ")])],1),t._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"日期:"}},[e("el-date-picker",{attrs:{type:"daterange",align:"left","unlink-panels":"","range-separator":"—","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.condition.selectDate,callback:function(a){t.$set(t.condition,"selectDate",a)},expression:"condition.selectDate"}})],1)],1)],1)],1),t._v(" "),e("div",{staticStyle:{"margin-bottom":"16px"},attrs:{align:"right"}},[e("el-tooltip",{attrs:{placement:"right"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("添加保养")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-plus",size:"small",type:"primary"},on:{click:t.onShowSelectMachine}})],1)],1),t._v(" "),e("div",[e("el-steps",{attrs:{simple:""}},[e("el-step",{attrs:{title:"添加保养",status:"process",icon:"el-icon-edit"}}),t._v(" "),e("el-step",{attrs:{title:"设置保养项",status:"finish",icon:"el-icon-setting"}}),t._v(" "),e("el-step",{attrs:{title:"派单",status:"success"}})],1)],1),t._v(" "),e("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","empty-text":"暂无数据...","highlight-current-row":"","show-overflow-tooltip":"true"}},[e("el-table-column",{attrs:{width:"75",align:"center",label:"序号"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n                            "+t._s(a.$index+t.startRow)+"\n                        ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"machineNameplate",label:"机器编号"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"machineType",label:"机型"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v("\n                                "+t._s(a.row.machineType)+"\n                            ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"订单号",sortable:"",align:"center",prop:"orderNum"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v("\n                                "+t._s(a.row.orderNum)+"\n                            ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"machineCustomerName",label:"客户"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"customerNameInMaintainRecord",label:"客户联系人"}}),t._v(" "),t.isAgentLogin()?t._e():e("el-table-column",{attrs:{align:"center",prop:"machineAgentName",label:"代理商"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"maintainLibName",label:"保养项"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"btn btn-link",staticStyle:{"font-weight":"bold"},attrs:{disabled:a.row.maintainStatus>2},on:{click:function(e){t.onEditMaintainLib(a.row)}}},[""==a.row.maintainLibName||null==a.row.maintainLibName?e("span",{staticStyle:{color:"red"}},[t._v("\n                                    点击设置\n                                ")]):e("span",[t._v("\n                                   "+t._s(a.row.maintainLibName)+"\n                                ")])])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"maintainStatus",sortable:"",label:"保养状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[0==a.row.maintainStatus?e("div",{staticStyle:{color:"#686868"}},[t._v("\n                                "+t._s(t._f("filterStatus")(a.row.maintainStatus))+"\n                            ")]):t._e(),t._v(" "),1==a.row.maintainStatus?e("div",{staticStyle:{color:"#8b6c0e"}},[t._v("\n                                "+t._s(t._f("filterStatus")(a.row.maintainStatus))+"\n                            ")]):t._e(),t._v(" "),2==a.row.maintainStatus?e("div",{staticStyle:{color:"#13678b"}},[t._v("\n                                "+t._s(t._f("filterStatus")(a.row.maintainStatus))+"\n                            ")]):t._e(),t._v(" "),3==a.row.maintainStatus?e("div",{staticStyle:{color:"#198b57"}},[t._v("\n                                "+t._s(t._f("filterStatus")(a.row.maintainStatus))+"\n                            ")]):t._e(),t._v(" "),4==a.row.maintainStatus?e("div",{staticStyle:{color:"darkred"}},[t._v("\n                                "+t._s(t._f("filterStatus")(a.row.maintainStatus))+"\n                            ")]):t._e()]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"出厂日期"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("\n                            "+t._s(t._f("filterDateString")(a.row.facoryDate))+"\n                        ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"计划日期"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("\n                            "+t._s(t._f("filterDateString")(a.row.maintainDatePlan))+"\n                        ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"完成日期"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("\n                            "+t._s(t._f("filterDateString")(a.row.maintainDateActual))+"\n                        ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"150",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{attrs:{placement:"top",content:"详情"}},[e("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-view"},on:{click:function(e){t.editWithItem(a.row)}}})],1),t._v(" "),e("el-tooltip",{attrs:{placement:"top",content:"派单"}},[e("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-news"},on:{click:function(e){t.assignTask(a.row)}}})],1)]}}])})],1),t._v(" "),e("div",{staticClass:"block",staticStyle:{"text-align":"center","margin-top":"20px"}},[e("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next, jumper",total:t.totalRecords},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{title:"保养项选择",visible:t.showMaintainDialog,"append-to-body":""},on:{"update:visible":function(a){t.showMaintainDialog=a}}},[e("el-form",{attrs:{"label-position":"right","label-width":"90px"}},[e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"保养项:"}},[e("el-select",{attrs:{clearable:""},model:{value:t.maintainLibName,callback:function(a){t.maintainLibName=a},expression:"maintainLibName"}},t._l(t.mainTainLibList,function(t){return e("el-option",{attrs:{value:t.maintainLibName,label:t.maintainLibName}})}))],1)],1)],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",staticStyle:{"margin-top":"100px"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(a){t.showMaintainDialog=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.onSaveMaintain}},[t._v("确 定")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"添加保养",visible:t.showSelectMachineDialog,"append-to-body":"",width:"50%"},on:{"update:visible":function(a){t.showSelectMachineDialog=a}}},[t.showSelectMachineDialog?e("SelectAssignMachine",{ref:"selectMachineControl",attrs:{dataChanged:t.onSelectMachineChanged}}):t._e(),t._v(" "),e("div",{staticClass:"dialog-footer",staticStyle:{"margin-bottom":"20px"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.onSelectMachineOK}},[t._v("确定\n                        ")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-back"},on:{click:function(a){t.showSelectMachineDialog=!1}}},[t._v("关闭")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"保养详情",visible:t.showDetailDialog,"append-to-body":"",fullscreen:""},on:{"update:visible":function(a){t.showDetailDialog=a}}},[t.showDetailDialog?e("MaintainDetail",{ref:"maintainDetail",attrs:{machineNameplate:t.machineNameplate,maintainRecorderInfo:t.selectedItem}}):t._e()],1),t._v(" "),e("el-dialog",{attrs:{title:"派单",visible:t.showAssignTaskDialog,"append-to-body":"",width:"75%"},on:{"update:visible":function(a){t.showAssignTaskDialog=a}}},[t.showAssignTaskDialog?e("AssignTask",{ref:"assignTask",attrs:{showType:t.assignTaskType,machineInfo:t.machineInfo,dataChanged:t.dataChanged}}):t._e(),t._v(" "),e("div",{staticClass:"dialog-footer",staticStyle:{"margin-bottom":"20px"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-check",disabled:t.isDisableOK},on:{click:t.onConfirmAssign}},[t._v("确定\n                        ")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-back"},on:{click:function(a){t.showAssignTaskDialog=!1}}},[t._v("关闭")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"提示",visible:t.showConfirmAssign,"append-to-body":"",width:"30%"},on:{"update:visible":function(a){t.showConfirmAssign=a}}},[e("span",[t._v("当前任务状态是"),e("span",{staticStyle:{"font-weight":"bold","font-size":"18px",color:"#1c8de0"}},[t._v(" "+t._s(t._f("filterStatus")(t.selectedItem.maintainStatus)))]),t._v(", 确定需要再次派单吗？")]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(a){t.showConfirmAssign=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.onConShowAssign}},[t._v("确 定")])],1)])],1)],1)])},staticRenderFns:[]};var _=e("VU/8")(g,h,!1,function(t){e("+lcp")},"data-v-6e3a84b7",null);a.default=_.exports},KzIj:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n,i=e("BO1k"),s=e.n(i),l=e("vt++"),o=e("V5TU"),r=e("weGg"),c=(e("0xDb"),e("IcnI")),m={name:"MaintainDetail",props:{machineNameplate:{type:String,default:""},maintainRecorderInfo:{type:Object,default:{}}},data:function(){return n=this,{loading:{},formData:{},activeTabId:0,maintainLibList:[],maintainCotentList:[],maintainTypeList:[],skillStars:{},statusList:l.a.MaintainStatusList,maintainMembers:[]}},filters:{filterStatus:function(t){for(var a="",e=0;e<n.statusList.length;e++)if(t==n.statusList[e].value){a=n.statusList[e].name;break}return a},filterDateString:function(t){return isStringEmpty(t)?"":new Date(t).format("yyyy-MM-dd")},filterMaintainTypeName:function(t){for(var a="",e=0;e<n.maintainTypeList.length;e++)if(t==n.maintainTypeList[e].id){a=n.maintainTypeList[e].maintainTypeName;break}return a}},computed:{isShowAgent:{get:function(){return n.activeTabId=isStringEmpty(n.formData.machineAgentName)?"2":"1",!isStringEmpty(n.formData.machineAgentName)}},isShowSinsim:{get:function(){return!(c.a.getters.user.user.agent>0)&&isStringEmpty(n.formData.machineAgentName)}}},methods:{onStarLoad:function(t){return Object(r.c)(t.starMode)},showCheckBox:function(t){return 1==t?"checkbox_checked":"checkbox_unchecked"},loadData:function(){this.formData={},null!=n.machineNameplate&&(this.formData=copyObject(n.maintainRecorderInfo)),n.maintainCotentList=[];try{n.maintainCotentList=JSON.parse(this.formData.maintainInfo)}catch(t){console.log(t)}},tabSwitchClick:function(t){console.log("tabSwitchClick:"+t)},loadMaintainTypeList:function(){Object(o.j)({page:"",size:""}).then(function(t){responseIsOK(t)?n.maintainTypeList=t.data.data.list:showMSG(n,isStringEmpty(t.data.message)?"查询数据失败！":t.data.message)})},loadMaintainMembers:function(){n.maintainMembers=[];var t={page:"",size:"",maintainRecordId:n.formData.id};Object(o.h)(t).then(function(t){responseIsOK(t)?n.maintainMembers=t.data.data.list:showMSG(n,isStringEmpty(t.data.message)?"查询数据失败！":t.data.message)})},loadMaintainLib:function(){Object(o.k)({maintainType:"1",maintainLibName:n.formData.maintainLibName,page:"",size:""}).then(function(t){responseIsOK(t)?(n.mainTainLibList=t.data.data.list,n.mainTainLibList.forEach(function(t){var a=!1,e=!0,i=!1,l=void 0;try{for(var o,r=s()(n.maintainCotentList);!(e=(o=r.next()).done);e=!0){var c=o.value;c.maintainType==t.maintainType&&(c.contentList.push({content:t.maintainContent,checkValue:0}),a=!0)}}catch(t){i=!0,l=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw l}}if(!a){var m={maintainType:t.maintainType,contentList:[]};m.contentList.push({content:t.maintainContent,checkValue:0}),n.maintainCotentList.push(m)}})):showMSG(n,isStringEmpty(t.data.message)?"查询数据失败！":t.data.message)})}},mounted:function(){n.loadMaintainTypeList(),n.loadData(),0==n.maintainCotentList.length&&n.loadMaintainLib(),n.loadMaintainMembers(),this.skillStars=Object(r.d)(n.formData.maintainFeedbackCustomerMark)}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"root_div"},[e("el-form",{attrs:{model:t.formData,"label-position":"right","label-width":"100px"}},[e("div",{staticClass:"panel panel-primary"},[e("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[e("h3",{staticClass:"panel-title"},[t._v("客户信息")])]),t._v(" "),e("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"客户:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.machineCustomerName)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"联系方式:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.machineCustomerPhone)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"代理商:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.machineAgentName)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"联系方式:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.machineAgentPhone)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"出厂日期:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.facoryDate)))])])],1)],1)]),t._v(" "),e("div",{staticClass:"panel panel-primary"},[e("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[e("h3",{staticClass:"panel-title"},[t._v("机器信息")])]),t._v(" "),e("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"机器编号:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.machineNameplate)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"机型:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.machineType)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"针数:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.needleNum)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"头数:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.headNum)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"头距:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.headDistance)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"X行程:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.xDistance)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"Y行程:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.yDistance)}})])],1)],1)]),t._v(" "),e("div",{staticClass:"panel panel-primary"},[e("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[e("h3",{staticClass:"panel-title"},[t._v("保养详情")])]),t._v(" "),e("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养联系人:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.customerNameInMaintainRecord)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"联系电话:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.customerPhoneInMaintainRecord)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"地址:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.customerAddressInMaintainRecord)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养员:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.maintainChargePersonName)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养时间:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.maintainDateActual)))])])],1)],1)]),t._v(" "),e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.tabSwitchClick},model:{value:t.activeTabId,callback:function(a){t.activeTabId=a},expression:"activeTabId"}},[e("el-tab-pane",{attrs:{label:"保养内容",name:"0"}},[e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养项:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.maintainLibName)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养时间:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.maintainDateActual)))])])],1)],1),t._v(" "),t.maintainCotentList.length>0?e("div",t._l(t.maintainCotentList,function(a){return e("div",{staticClass:"panel panel-primary",staticStyle:{"font-weight":"bold","font-size":"20px"}},[e("div",{staticClass:"panel-heading",staticStyle:{"text-align":"left"}},[e("span",{staticClass:"panel-title"},[t._v(t._s(t._f("filterMaintainTypeName")(a.maintainType)))])]),t._v(" "),e("div",{staticClass:"panel-body"},t._l(a.contentList,function(a){return e("el-col",{attrs:{span:20}},[e("svg-icon",{staticStyle:{width:"30px",height:"30px","margin-left":"3px","margin-top":"5px"},attrs:{"icon-class":t.showCheckBox(a.checkValue)}}),t._v(" "),e("span",{staticStyle:{"font-weight":"bold","font-size":"20px","margin-left":"5px"}},[t._v(t._s(a.content))])],1)}))])})):e("span",[t._v("\n                    暂无内容\n                ")])],1),t._v(" "),t.isShowAgent?e("el-tab-pane",{attrs:{label:"代理商保养",name:"1"}},[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养负责人:"}},[e("el-tag",{staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                "+t._s(t.formData.maintainChargePersonName)+"\n                        ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"联系电话:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.maintainChargePersonPhone)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养时间:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.maintainDateActual)))])])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"计划时间:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.maintainDatePlan)))])])],1),t._v(" "),e("el-row",[e("el-col",[e("el-form-item",{attrs:{label:"保养人员:"}},t._l(t.maintainMembers,function(a){return e("el-tag",{key:a.name,staticClass:"tagClass",attrs:{type:"info"}},[t._v("\n                                "+t._s(a.name)+"\n                            ")])}))],1)],1),t._v(" "),e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"保养建议:"}},[e("span",[t._v(t._s(t.formData.maintainSuggestion))])])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养结果:"}},[0==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#686868"}},[t._v("\n                                "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),1==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#8b6c0e"}},[t._v("\n                                "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),2==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#13678b"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),3==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#198b57"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),4==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"darkred"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e()])],1)],1):t._e(),t._v(" "),t.isShowSinsim?e("el-tab-pane",{attrs:{label:"信胜保养",name:"2"}},[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养负责人:"}},[e("el-tag",{staticClass:"tagClass",attrs:{type:"success"}},[t._v("\n                                "+t._s(t.formData.maintainChargePersonName)+"\n                        ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"联系电话:"}},[e("span",{domProps:{innerHTML:t._s(t.formData.maintainChargePersonPhone)}})])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养时间:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.maintainDateActual)))])])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"计划时间:"}},[e("span",[t._v(t._s(t._f("filterDateString")(t.formData.maintainDatePlan)))])])],1),t._v(" "),e("el-row",[e("el-col",[e("el-form-item",{attrs:{label:"保养人员:"}},t._l(t.maintainMembers,function(a){return e("el-tag",{key:a.name,staticClass:"tagClass",attrs:{type:"info"}},[t._v("\n                                "+t._s(a.name)+"\n                            ")])}))],1)],1),t._v(" "),e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"保养建议:"}},[e("span",[t._v(t._s(t.formData.maintainSuggestion))])])],1),t._v(" "),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"保养结果:"}},[0==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#686868"}},[t._v("\n                                "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),1==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#8b6c0e"}},[t._v("\n                                "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),2==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#13678b"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),3==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"#198b57"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e(),t._v(" "),4==t.formData.maintainStatus?e("div",{staticClass:"status_class",staticStyle:{color:"darkred"}},[t._v("\n                            "+t._s(t._f("filterStatus")(t.formData.maintainStatus))+"\n                        ")]):t._e()])],1)],1):t._e(),t._v(" "),e("el-tab-pane",{attrs:{label:"客户评价",name:"3"}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"用户评分:"}},[e("div",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[t._l(t.skillStars,function(a){return e("div",{staticStyle:{float:"left"}},[e("svg-icon",{staticStyle:{width:"30px",height:"30px",margin:"3px"},attrs:{"icon-class":t.onStarLoad(a),"data-toggle":"tooltip","data-placement":"top",title:a.score}})],1)}),t._v(" "),""!=t.formData.maintainFeedbackCustomerMark?e("div",{staticClass:"control-label",staticStyle:{float:"left","margin-left":"10px","font-weight":"bold"}},[t._v("\n                                        "+t._s(t.formData.maintainFeedbackCustomerMark)+"分\n                            ")]):e("div",{staticClass:"control-label",staticStyle:{float:"left","margin-left":"10px","font-weight":"bold"}},[t._v("\n                                        暂无评分\n                            ")])],2)])],1),t._v(" "),e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"用户评论:"}},[e("div",{staticClass:"control-label",staticStyle:{float:"left","margin-left":"10px","font-weight":"bold"}},[t._v("\n                            "+t._s(t.formData.maintainFeedbackCustomerSuggestion)+"\n                        ")])])],1)],1)],1)],1)],1)},staticRenderFns:[]};var u=e("VU/8")(m,d,!1,function(t){e("Lzub")},"data-v-6c530fd4",null);a.default=u.exports},Lzub:function(t,a,e){var n=e("YbnE");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e("rjj0")("a8e45438",n,!0)},YbnE:function(t,a,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n.root_div[data-v-6c530fd4] {\n\tposition: relative;\n\tpadding: 20px;\n\twidth: 100%;\n}\nspan[data-v-6c530fd4] {\n\tfont-size: 18px;\n\twidth: 100%;\n\talignment: left;\n\ttext-align: left;\n}\n.tagClass[data-v-6c530fd4] {\n\tmargin-left: 5px;\n\twidth: 200px;\n}\n.status_class[data-v-6c530fd4] {\n\tfont-size: 18px;\n\tfont-weight: bold;\n}\n",""])},bOdI:function(t,a,e){"use strict";a.__esModule=!0;var n,i=e("C4MV"),s=(n=i)&&n.__esModule?n:{default:n};a.default=function(t,a,e){return a in t?(0,s.default)(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}},"d/Vj":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n,i=e("bOdI"),s=e.n(i),l=e("woOf"),o=e.n(l),r=e("vt++"),c=e("weGg"),m=e("0xDb"),d={name:"SelectAssignMachine",props:{dataChanged:{type:Function,default:null}},data:function(){return n=this,{loading:{},formData:{},keyWord:"",selectKey:"",tableData:[],selectedItem:{},pageSize:r.a.EveryPageNum,currentPage:1,startRow:0,totalRecords:0,multipleSelection:[]}},filters:{filterDateString:function(t){return new Date(t).format("yyyy-MM-dd")}},methods:{handleSelectionChange:function(t){n.multipleSelection=t,n.dataChanged(n.getCurrentData())},handleCurrentChange:function(t){this.currentPage=t,this.loadData()},onSearch:function(){this.currentPage=1,n.loadData()},loadData:function(){Object(m.b)(n.formData),Object(m.b)(n.selectedItem),n.tableData=[],n.loading=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});var t={page:n.currentPage,size:n.pageSize,isFuzzy:!0};isStringEmpty(n.selectKey)||(t=o()(t,s()({},n.selectKey,n.keyWord))),Object(c.b)(t).then(function(t){responseIsOK(t)?t.data.data.list.length>0&&(n.tableData=t.data.data.list,n.totalRecords=t.data.data.total,n.startRow=t.data.data.startRow):showMSG(n,isStringEmpty(t.data.message)?"加载数据失败！":t.data.message),n.loading.close()}).catch(function(t){n.loading.close()})},checkStatusChange:function(t){n.selectedItem=copyObject(t),n.dataChanged(n.getCurrentData())},loadingClose:function(){n.loading.close()},getCurrentData:function(){return n.multipleSelection}},watch:{selectedItem:function(t){n.dataChanged(n.getCurrentData())},tableData:function(t){n.dataChanged(n.getCurrentData())}},mounted:function(){n.loadData()}},u={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-form",{attrs:{model:t.formData,"label-position":"right","label-width":"100px"}},[e("div",{staticClass:"panel-body",staticStyle:{"margin-left":"-20px"}},[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"查询词"}},[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:"输入查询词"},model:{value:t.keyWord,callback:function(a){t.keyWord=a},expression:"keyWord"}},[e("el-select",{staticStyle:{width:"180px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.selectKey,callback:function(a){t.selectKey=a},expression:"selectKey"}},[e("el-option",{attrs:{label:"机器编号",value:"nameplate"}}),t._v(" "),e("el-option",{attrs:{label:"订单号",value:"orderNum"}}),t._v(" "),e("el-option",{attrs:{label:"客户",value:"customerName"}})],1),t._v(" "),e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.onSearch},slot:"append"})],1)],1)],1)],1)]),t._v(" "),e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","empty-text":"暂无数据...","show-overflow-tooltip":"true"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{width:"75",align:"center",label:"序号"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n                            "+t._s(a.$index+t.startRow)+"\n                        ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"nameplate",label:"机器编号"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"machineType",label:"机型"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v("\n                        "+t._s(a.row.machineType)+"\n                    ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"订单号",align:"center",prop:"orderNum"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v("\n                        "+t._s(a.row.orderNum)+"\n                    ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"customerName",label:"客户"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"agent",label:"代理商"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"出厂日期"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("\n                            "+t._s(t._f("filterDateString")(a.row.facoryDate))+"\n                        ")])]}}])})],1),t._v(" "),e("div",{staticClass:"block",staticStyle:{"text-align":"center","margin-top":"20px"}},[e("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next, jumper",total:t.totalRecords},on:{"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var f=e("VU/8")(d,u,!1,function(t){e("0Iwh")},"data-v-ecc22230",null);a.default=f.exports},mClu:function(t,a,e){var n=e("kM2E");n(n.S+n.F*!e("+E39"),"Object",{defineProperty:e("evD5").f})}});